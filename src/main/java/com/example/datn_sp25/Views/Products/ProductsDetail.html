<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Chi ti·∫øt s·∫£n ph·∫©m</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css"/>
    <style>
        .empty-cart {
            text-align: center;
            color: #999;
            padding: 2rem 1rem;
        }
        .empty-cart img {
            max-width: 150px;
            opacity: 0.4;
        }
    </style>
</head>
<body>

<!-- HEADER -->
<header id="mainHeader" class="bg-white border-bottom py-3 sticky-top shadow-sm">
    <div class="container d-flex align-items-center justify-content-between flex-wrap">
        <!-- Logo -->
        <div class="logo me-4">
            <img src="https://theme.hstatic.net/200000000133/1001205759/14/logo.png?v=2074" alt="VPS Fashion" height="50">
        </div>

        <!-- Menu -->
        <nav class="d-flex menu flex-grow-1 align-items-center">
            <a href="../Homes/Home.html" class="nav-link text-dark px-2 fw-medium">Trang ch·ªß</a>
            <a href="#" class="nav-link text-dark px-2 fw-medium">ƒê·ªì Nam</a>
            <a href="../Introduces/index.html" class="nav-link text-dark px-2 fw-medium">Gi·ªõi thi·ªáu</a>
            <a href="../Contact/index.html" class="nav-link text-dark px-2 fw-medium">Li√™n h·ªá</a>
            <div class="ms-auto d-flex align-items-center search-bar">
                <img src="../../Assets/icons/search.png" alt="Y√™u th√≠ch" class="icon-img me-3">
                <input type="text" placeholder="B·∫°n Mu·ªën T√¨m g√¨..." class="form-control form-control-sm me-2" style="width: 200px;">
                <button class="btn btn-secondary btn-sm">T√¨m Ki·∫øm</button>
            </div>
        </nav>

        <!-- Icons -->
        <div class="icons d-flex align-items-center ms-3">
            <img src="../../Assets/icons/favorite.png" alt="Y√™u th√≠ch" class="icon-img me-3" title="Y√™u th√≠ch">
            <img src="../../Assets/icons/shopping-cart.png" alt="Gi·ªè h√†ng" class="icon-img me-3" title="Gi·ªè h√†ng"
                 data-bs-toggle="offcanvas" data-bs-target="#cartSidebar" style="cursor: pointer;">
            <img src="../../Assets/icons/user.png" alt="T√†i kho·∫£n" class="icon-img me-3" title="T√†i kho·∫£n">
        </div>
    </div>
</header>

<!-- N·ªôi dung chi ti·∫øt s·∫£n ph·∫©m -->
<div class="container product-detail-container">
    <div class="row align-items-center">
        <!-- ·∫¢nh ch√≠nh -->
        <div class="col-md-4 text-center">
            <div class="position-relative d-inline-block">
                <img id="mainImage" src="https://theme.hstatic.net/200000000133/1001205759/14/home_category_1_img.jpg?v=2074"
                     class="img-fluid mb-3 border" style="width: 100%; max-width: 300px;" alt="·∫¢nh s·∫£n ph·∫©m ch√≠nh"/>
                <span class="badge bg-danger position-absolute top-0 start-0 m-2">-60%</span>
            </div>
        </div>

        <!-- Th√¥ng tin -->
        <div class="col-md-5">
            <h1 class="product-name" id="productName">√Åo Tay D√†i N·ªØ</h1>
            <p class="product-price">Gi√°: <span class="text-danger fw-bold" id="productPrice">299.000ƒë</span></p>
            <div class="mb-2"><strong>SIZE:</strong></div>
            <div class="btn-group size-options mb-3" role="group">
                <input type="radio" class="btn-check" name="size" id="sizeS" checked><label class="btn btn-outline-dark" for="sizeS">S</label>
                <input type="radio" class="btn-check" name="size" id="sizeM"><label class="btn btn-outline-dark" for="sizeM">M</label>
                <input type="radio" class="btn-check" name="size" id="sizeL"><label class="btn btn-outline-dark" for="sizeL">L</label>
                <input type="radio" class="btn-check" name="size" id="sizeXL"><label class="btn btn-outline-dark" for="sizeXL">XL</label>
                <input type="radio" class="btn-check" name="size" id="sizeXXL"><label class="btn btn-outline-dark" for="sizeXXL">XXL</label>
            </div>

            <div class="mb-3">
                <label for="quantity"><strong>S·ªë L∆∞·ª£ng</strong></label>
                <input type="number" id="quantity" class="form-control w-50" value="1" min="1">
            </div>

            <div class="mb-3">
                <button class="btn btn-danger me-2 px-4">MUA NGAY</button>
                <button class="btn btn-outline-secondary" id="addToCartBtn" title="Th√™m v√†o gi·ªè h√†ng">
                    <img src="../../Assets/icons/shopping-cart.png" alt="Th√™m v√†o gi·ªè h√†ng" width="20" height="20">
                </button>
            </div>

            <p class="text-muted small">G·ªçi <strong>Hotline:</strong> 0363652758 ƒë·ªÉ ƒë·∫∑t h√†ng nhanh nh·∫•t</p>
        </div>

        <!-- ·∫¢nh ph·ª• -->
        <div class="col-md-3 text-center">
            <div class="position-relative border p-1" style="display: inline-block; max-width: 200px;">
                <img id="subImage" src="https://theme.hstatic.net/200000000133/1001205759/14/home_category_1_img.jpg?v=2074" class="img-fluid" style="max-width: 200px;" alt="·∫¢nh ph·ª•"/>
                <span class="position-absolute top-50 start-0 translate-middle-y text-dark fs-4 btn-prev" style="cursor: pointer;">‚ùÆ</span>
                <span class="position-absolute top-50 end-0 translate-middle-y text-dark fs-4 btn-next" style="cursor: pointer;">‚ùØ</span>
            </div>
        </div>
    </div>
</div>

<!-- S·∫£n ph·∫©m li√™n quan -->
<div class="container py-5">
    <div class="divider-title">S·∫£n Ph·∫©m Li√™n Quan</div>

    <div class="row related-products g-3" id="product-list">
        <!-- C√°c s·∫£n ph·∫©m s·∫Ω ƒë∆∞·ª£c th√™m ·ªü ƒë√¢y qua JavaScript -->
    </div>

    <div class="text-center mt-4">
        <button class="btn btn-danger px-4" id="loadMoreBtn" onclick="loadMore()">Xem Th√™m</button>
    </div>
</div>

<!-- FOOTER -->
<footer class="bg-dark text-white py-5">
    <div class="container">
        <div class="row g-4">
            <div class="col-md-4">
                <h5>V·ªÄ CH√öNG T√îI</h5>
                <p>YFashion l√† th∆∞∆°ng hi·ªáu th·ªùi trang nam nƒÉng ƒë·ªông, hi·ªán ƒë·∫°i v√† tr·∫ª trung...</p>
            </div>
            <div class="col-md-4">
                <h5>ƒê∆Ø·ªúNG D·∫™aN</h5>
                <ul class="list-unstyled">
                    <li><a href="#" class="text-white-50 text-decoration-none">Trang ch·ªß</a></li>
                    <li><a href="#" class="text-white-50 text-decoration-none">V·ªÅ ch√∫ng t√¥i</a></li>
                    <li><a href="#" class="text-white-50 text-decoration-none">Li√™n h·ªá</a></li>
                </ul>
            </div>
            <div class="col-md-4">
                <h5>LI√äN H·ªå</h5>
                <p>üìç S·ªë 3, ƒë∆∞·ªùng Tr·ªãnh VƒÉn B√¥, Nam T·ª´ Li√™m, H√† N·ªôi</p>
                <p>üìû 0363652758</p>
                <p>‚úâÔ∏è Buianhtuan.dev@gmail.com</p>
                <form class="d-flex">
                    <input type="email" class="form-control me-2" placeholder="Email address">
                    <button class="btn btn-secondary">G·ª≠i</button>
                </form>
            </div>
        </div>
    </div>
</footer>

<!-- TOAST MESSAGE -->
<div class="position-fixed bottom-0 end-0 p-3" style="z-index: 9999">
    <div id="toastMsg" class="toast align-items-center text-white bg-success border-0" role="alert">
        <div class="d-flex">
            <div class="toast-body"></div>
            <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
        </div>
    </div>
</div>

<!-- OFFCANVAS GI·ªé H√ÄNG -->
<div class="offcanvas offcanvas-end" tabindex="-1" id="cartSidebar" aria-labelledby="cartSidebarLabel">
    <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="cartSidebarLabel">üõí Gi·ªè h√†ng</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
    </div>
    <div class="offcanvas-body">
        <!-- N·∫øu kh√¥ng c√≥ s·∫£n ph·∫©m -->
        <div id="emptyMessage" class="empty-cart text-center d-none">
            <img src="https://cdn-icons-png.flaticon.com/512/2038/2038854.png" alt="No product" style="width: 100px; opacity: 0.5;" />
            <p class="mt-3 text-muted">Kh√¥ng c√≥ s·∫£n ph·∫©m trong gi·ªè h√†ng</p>
        </div>

        <!-- S·∫£n ph·∫©m ƒë∆∞·ª£c th√™m v√†o ƒë√¢y -->
        <div id="cart-content"></div>

        <!-- Hi·ªÉn th·ªã khi c√≥ s·∫£n ph·∫©m -->
        <div id="cartSummary" class="d-none mt-3">
            <div class="d-flex justify-content-between">
                <strong>T·∫°m t√≠nh:</strong>
                <strong id="subtotal">0 ƒë</strong>
            </div>
            <button class="btn btn-danger w-100 mt-3" id="checkoutBtn" disabled>MUA NGAY</button>
        </div>
    </div>
</div>

<script>
    // Chuy·ªÉn gi√° th√†nh s·ªë
    function parsePrice(text) {
        return parseInt(text.replace(/[^\d]/g, "")) || 0;
    }

    // C·∫≠p nh·∫≠t t·ªïng t·∫°m t√≠nh
    function updateSubtotal() {
        let subtotal = 0;
        let hasSelected = false;

        document.querySelectorAll(".cart-item").forEach(item => {
            const checkbox = item.querySelector("input[type='checkbox']");
            if (checkbox && checkbox.checked) {
                const price = parsePrice(item.getAttribute("data-price"));
                const quantity = parseInt(item.getAttribute("data-quantity")) || 1;
                subtotal += price * quantity;
                hasSelected = true;
            }
        });

        document.getElementById("subtotal").textContent = subtotal.toLocaleString("vi-VN") + " ƒë";

        const checkoutBtn = document.getElementById("checkoutBtn");
        if (hasSelected) {
            checkoutBtn.disabled = false;
            checkoutBtn.classList.remove("btn-secondary");
            checkoutBtn.classList.add("btn-danger");
        } else {
            checkoutBtn.disabled = true;
            checkoutBtn.classList.remove("btn-danger");
            checkoutBtn.classList.add("btn-secondary");
        }
    }

    // Hi·ªÉn th·ªã/·∫©n th√¥ng b√°o kh√¥ng c√≥ s·∫£n ph·∫©m
    function checkEmptyCart() {
        const cartItems = document.querySelectorAll(".cart-item");
        const emptyMessage = document.getElementById("emptyMessage");
        const cartSummary = document.getElementById("cartSummary");

        const isEmpty = cartItems.length === 0;

        emptyMessage.classList.toggle("d-none", !isEmpty);
        cartSummary.classList.toggle("d-none", isEmpty);
    }

    // Hi·ªÉn th·ªã toast th√¥ng b√°o
    function showToast(message, isSuccess = true) {
        const toastEl = document.getElementById("toastMsg");
        const body = toastEl.querySelector(".toast-body");
        body.textContent = message;

        toastEl.classList.remove("bg-success", "bg-danger");
        toastEl.classList.add(isSuccess ? "bg-success" : "bg-danger");

        const toast = new bootstrap.Toast(toastEl);
        toast.show();
    }

    // T·∫°o item s·∫£n ph·∫©m trong gi·ªè h√†ng
    function createCartItem(name, price, image, size, quantity) {
        const wrapper = document.createElement("div");
        wrapper.className = "d-flex mb-3 align-items-center cart-item";
        wrapper.setAttribute("data-price", parsePrice(price));
        wrapper.setAttribute("data-quantity", quantity);

        wrapper.innerHTML = `
            <input type="checkbox" class="form-check-input me-2" checked>
            <img src="${image}" alt="${name}" width="60" class="me-2">
            <div>
                <p class="mb-1">${name}</p>
                <small>Size: ${size}</small><br>
                <small>S·ªë l∆∞·ª£ng: ${quantity}</small>
            </div>
            <span class="ms-auto fw-bold">${price}</span>
            <button class="btn btn-sm btn-close ms-2" title="X√≥a"></button>
        `;

        // S·ª± ki·ªán xo√° s·∫£n ph·∫©m
        wrapper.querySelector(".btn-close").onclick = () => {
            if (confirm("B·∫°n c√≥ mu·ªën x√≥a s·∫£n ph·∫©m n√†y kh·ªèi gi·ªè h√†ng?")) {
                wrapper.remove();
                updateSubtotal();
                checkEmptyCart();
            }
        };

        // Khi tick checkbox
        wrapper.querySelector("input[type='checkbox']").addEventListener("change", updateSubtotal);

        return wrapper;
    }

    // Khi DOM ƒë√£ load xong
    document.addEventListener("DOMContentLoaded", () => {
        const addToCartBtn = document.getElementById("addToCartBtn");

        addToCartBtn?.addEventListener("click", () => {
            try {
                const name = document.getElementById("productName")?.textContent || "S·∫£n ph·∫©m kh√¥ng t√™n";
                const price = document.getElementById("productPrice")?.textContent || "0ƒë";
                const image = document.getElementById("mainImage")?.src || "";
                const size = document.querySelector('input[name="size"]:checked')?.nextElementSibling?.textContent || "M";
                const quantity = parseInt(document.getElementById("quantity")?.value || "1");

                const cartItem = createCartItem(name, price, image, size, quantity);
                const cartContent = document.getElementById("cart-content");

                cartContent.appendChild(cartItem);

                updateSubtotal();
                checkEmptyCart();

                // M·ªü gi·ªè h√†ng
                const cartSidebar = new bootstrap.Offcanvas('#cartSidebar');
                cartSidebar.show();

                showToast("‚úîÔ∏è ƒê√£ th√™m v√†o gi·ªè h√†ng");
            } catch (err) {
                showToast("‚ùå L·ªói khi th√™m s·∫£n ph·∫©m", false);
                console.error(err);
            }
        });

        checkEmptyCart(); // Ki·ªÉm tra l·∫°i khi load trang
    });
</script>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<!-- Script -->
<script src="../Homes/script.js"></script>
</body>
</html>
